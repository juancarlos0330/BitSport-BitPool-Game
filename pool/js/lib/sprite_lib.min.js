function CSpriteLibrary(){var t,i,r,e,o,n,s={};this.init=function(s,a,d){t={},i=0,r=0,e=s,o=a,n=d},this.addSprite=function(r,e){if(s.hasOwnProperty(r))return!1;var o=new Image;return s[r]=t[r]={szPath:e,oSprite:o,bLoaded:!1},i++,!0},this.getSprite=function(t){return s.hasOwnProperty(t)?s[t].oSprite:null},this._onSpritesLoaded=function(){i=0,o.call(n)},this._onSpriteLoaded=function(){e.call(n),++r===i&&this._onSpritesLoaded()},this.loadSprites=function(){for(var i in t)t[i].oSprite.oSpriteLibrary=this,t[i].oSprite.szKey=i,t[i].oSprite.onload=function(){this.oSpriteLibrary.setLoaded(this.szKey),this.oSpriteLibrary._onSpriteLoaded(this.szKey)},t[i].oSprite.onerror=function(i){var r=i.currentTarget;setTimeout(function(){t[r.szKey].oSprite.src=t[r.szKey].szPath},500)},t[i].oSprite.src=t[i].szPath},this.setLoaded=function(t){s[t].bLoaded=!0},this.isLoaded=function(t){return s[t].bLoaded},this.getNumSprites=function(){return i}}