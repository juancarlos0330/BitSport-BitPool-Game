function CInteractiveHelp(e){var t,i,r,a,n,o,s,c,_,l,T,h,E,d,u,v,C;this._init=function(e){t=e,i=new createjs.Container,t.addChild(i),r=new createjs.Container,i.addChild(r),(o=new createjs.Shape).graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT),o.alpha=INTERACTIVE_ALPHA_FADE,i.addChild(o),i.alpha=0,a=new createjs.Container,i.addChild(a);var c=s_oSpriteLibrary.getSprite("but_next");T={x:CANVAS_WIDTH-c.width/2-10,y:c.height/2+10};S={x:0,y:0};(_=new CGfxButton(S.x,S.y,c,a)).addEventListener(ON_MOUSE_UP,this._onPressUpButSkip,this),n=new createjs.Container,i.addChild(n);var A=s_oSpriteLibrary.getSprite("but_continue");h={x:CANVAS_WIDTH-c.width/2-10,y:CANVAS_HEIGHT-c.height/2-10};var S={x:0,y:0};l=new CGfxButton(S.x,S.y,A,n);new CTLText(a,-c.width-220,-50,240,80,60,"right","#fff",FONT_GAME,1.1,0,0,TEXT_INTERACTIVE_HELP_SKIP_TUTORIAL,!0,!0,!1,!1),(E=new Array)[TUTORIAL_MOVE_STICK_BUTTONS]={toExecute:!0,cb:this._tutorialMoveStick},E[TUTORIAL_SHOT_DESKTOP]={toExecute:!0,cb:this._tutorialShotWithStickDesktop},E[TUTORIAL_RESPOT_CUE]={toExecute:!0,cb:this._tutorialRespotCue},E[TUTORIAL_CUE_EFFECT]={toExecute:!0,cb:this._tutorialCueEffect},E[TUTORIAL_SHOT_MOBILE]={toExecute:!0,cb:this._tutorialShotWithStickMobile},E[TUTORIAL_MOVE_STICK_MOBILE]={toExecute:!0,cb:this._tutorialMoveStickMobile},s=!1,d=new Array,u=new Array,v=new Array,C=new Array},this.startTutorial=function(e){var t=e.tutorial;if(E[t].toExecute)if(s)d.push({info:e.info,tutorial:t});else{var a=INTERACTIVE_ALPHA_FADE,n=E[t].cb;r.alpha=1,i.alpha=0;createjs.Tween.get(i,{override:!0}).to({alpha:1},500,createjs.Ease.cubicOut).call(function(){var t=e.info.on_show_tutorial;void 0!==t&&t.cb.call(t.scope,t.param)}),createjs.Tween.get(o,{override:!0}).to({alpha:a},500,createjs.Ease.cubicIn);var _={cb:n,scope:this,param:e.info};c=t,E[t].toExexute=!1,s=!0,e.info.movement?e.info.item.animMovement(e.info.pos,_,e.info.cb_movement):_.cb.call(_.scope,_.param)}},this._tutorialShotWithStickMobile=function(e){var t=e.param,i=s_oSpriteLibrary.getSprite("bg_interactive_help_3"),a=createBitmap(i);r.addChild(a),o.removeAllEventListeners();var n=new createjs.Container;r.addChild(n),n.x=691,n.y=500;var s={x:0,y:0},c=TEXT_INTERACTIVE_STICK_SHOT_MOBILE;new CTLText(n,s.x-350,s.y-75,700,150,40,"center","#fff",FONT_GAME,1.1,0,0,c,!0,!0,!0,!1);var _=this.createHand();_.gotoAndStop("idle"),_.x=240,_.y=370,_.rotation=135,r.addChild(_);createjs.Tween.get(_,{loop:!0}).call(function(){createjs.Tween.get(_).to({scaleX:.8,scaleY:.8},200),t._onPressMouseDown({stageX:240,stageY:370})}).wait(200+s_iTimeElaps).call(function(){createjs.Tween.get(_).to({y:870},1e3,createjs.Ease.cubicInOut).on("change",function(){t._onPressMove({stageY:_.y})})}).wait(1e3+s_iTimeElaps).call(function(){createjs.Tween.get(_).to({scaleX:1,scaleY:1},200),t._reset(300),t._onPressUp()}).wait(300+s_iTimeElaps).call(function(){createjs.Tween.get(_).to({y:370},500,createjs.Ease.cubicIn)}).wait(400+s_iTimeElaps);var T=function(){_.removeAllEventListeners(),createjs.Tween.removeTweens(_),this._endRespotCueTutorial()};l.addEventListener(ON_MOUSE_UP,T,this),o.on("click",T,this,!1)},this._tutorialMoveStickMobile=function(){var e=new createjs.Shape;e.graphics.beginFill("rgba(0, 0, 0, 0.8").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT),r.addChild(e),o.removeAllEventListeners();var t=new createjs.Container;r.addChild(t),t.x=CANVAS_WIDTH/2,t.y=270;var i={x:0,y:0},a=TEXT_INTERACTIVE_HELP_MOVE_STICK_MOBILE_DRAG;new CTLText(t,i.x-500,i.y-75,1e3,150,40,"center","#fff",FONT_GAME,1.1,0,0,a,!0,!0,!0,!1);var n=s_oSpriteLibrary.getSprite("ball_spin_gui"),s=createBitmap(n);s.x=CANVAS_WIDTH/2,s.y=CANVAS_HEIGHT/2,s.regX=n.width/2,s.regY=n.height/2,s.scaleX=s.scaleY=.29,r.addChild(s);var c=new createjs.Container;c.x=s.x-s.regX*s.scaleX,c.y=s.y,r.addChild(c);var _=s_oSpriteLibrary.getSprite("stick"),T=createBitmap(_);T.x=BALL_RADIUS,T.regX=_.width+BALL_RADIUS,T.regY=_.height/2,c.addChild(T);var h=s_oSpriteLibrary.getSprite("hand_anim_0"),E=createBitmap(h);E.regX=h.width/2,E.regY=h.height/1.5,E.x=T.regX/2,E.y=100,E.rotation=135,c.addChild(E);var d=function(){var e=linearFunction(E.y,-100,100,-20,20);T.y=.25*-e,T.rotation=e};d.call(this);var u=createjs.Tween.get(E,{loop:!0}).to({y:-100},1e3,createjs.Ease.cubicInOut).to({y:100},1e3,createjs.Ease.cubicInOut);u.on("change",d);var v=function(){u.removeAllEventListeners(),this._endShotWithStickTutorial(u)};l.addEventListener(ON_MOUSE_UP,v,this),o.on("click",v,this,!1)},this._tutorialShotWithStickDesktop=function(){var e=new createjs.Shape;e.graphics.beginFill("rgba(0, 0, 0, 0.8").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT),r.addChild(e),o.removeAllEventListeners();var t=new createjs.Container;r.addChild(t),t.x=CANVAS_WIDTH/2,t.y=300;var i={x:0,y:0},a=TEXT_INTERACTIVE_STICK_SHOT_DESKTOP;new CTLText(t,i.x-350,i.y-75,700,150,40,"center","#fff",FONT_GAME,1.1,0,0,a,!0,!0,!0,!1);var n=s_oSpriteLibrary.getSprite("ball_spin_gui"),s=createBitmap(n);s.x=CANVAS_WIDTH/2,s.y=CANVAS_HEIGHT/2,s.regX=n.width/2,s.regY=n.height/2,s.scaleX=s.scaleY=.29,r.addChild(s);var c=new createjs.Container;c.x=s.x-s.regX*s.scaleX,c.y=s.y,r.addChild(c);var _=s_oSpriteLibrary.getSprite("stick"),T=createBitmap(_);T.regX=_.width,T.regY=_.height/2,c.addChild(T);var h=s_oSpriteLibrary.getSprite("hand_anim_0"),E=createBitmap(h);E.regX=h.width/2,E.regY=h.height/2,E.x=-T.regX/2,E.y=100,E.rotation=180,c.addChild(E);createjs.Tween.get(c,{loop:!0}).to({x:c.x-100},500,createjs.Ease.cubicIn).call(function(){createjs.Tween.get(E).to({alpha:0},300)}).wait(301).to({x:c.x+3},200,createjs.Ease.cubicIn).call(function(){createjs.Tween.get(s,{override:!0}).to({x:CANVAS_WIDTH,alpha:0},700)}).wait(701).call(function(){createjs.Tween.get(E,{override:!0}).to({alpha:1},400),s.x=CANVAS_WIDTH/2,s.y=CANVAS_HEIGHT/2,createjs.Tween.get(s,{override:!0}).to({alpha:1},400),createjs.Tween.get(c).to({x:s.x-s.regX*s.scaleX},400)}).wait(401);var d=function(){this._endShotWithStickTutorial(c)};o.on("click",d,this,!1),l.addEventListener(ON_MOUSE_UP,d,this)},this._endShotWithStickTutorial=function(e){this.endTutorial(),createjs.Tween.removeTweens(e),o.removeAllEventListeners(),o.on("click",function(){})},this._tutorialCueEffect=function(e){var t=s_oSpriteLibrary.getSprite("bg_interactive_help_2"),i=createBitmap(t);r.addChild(i),o.removeAllEventListeners();var a=function(){this._endRespotCueTutorial()};l.addEventListener(ON_MOUSE_UP,a,this),o.on("click",a,this,!1);var n=new createjs.Container;r.addChild(n),n.x=480,n.y=600;var s={x:0,y:0},c=s_bMobile?TEXT_INTERACTIVE_HELP_CUE_EFFECT_MOBILE:TEXT_INTERACTIVE_HELP_CUE_EFFECT_DESKTOP;new CTLText(n,s.x-300,s.y-75,600,150,40,"center","#fff",FONT_GAME,1.1,0,0,c,!0,!0,!0,!1);var _=this.createHand();_.x=n.x,_.y=760,r.addChild(_)},this._endCueEffectTutorial=function(){this.endTutorial(),o.removeAllEventListeners(),o.on("click",function(){})},this._tutorialRespotCue=function(e){var t=s_oSpriteLibrary.getSprite("bg_interactive_help_1"),i=createBitmap(t);r.addChild(i),o.removeAllEventListeners();var a=function(){this._endRespotCueTutorial()};l.addEventListener(ON_MOUSE_UP,a,this),o.on("click",a,this,!1);var n=new createjs.Container;r.addChild(n),n.x=691,n.y=200;var s={x:0,y:0},c=s_bMobile?TEXT_INTERACTIVE_HELP_RESPOT_CUE_MOBILE:TEXT_INTERACTIVE_HELP_RESPOT_CUE_DESKTOP;new CTLText(n,s.x-350,s.y-75,700,150,40,"center","#fff",FONT_GAME,1.1,0,0,c,!0,!0,!0,!1);var _=this.createHand();_.x=n.x,_.y=380,r.addChild(_)},this._endRespotCueTutorial=function(){this.endTutorial(),o.removeAllEventListeners(),o.on("click",function(){})},this._tutorialMoveStick=function(e){var t=s_oSpriteLibrary.getSprite("bg_interactive_help_0"),i=createBitmap(t);r.addChild(i),o.removeAllEventListeners(),oCbCompleted=function(){this._endMoveStickTutorial()},l.addEventListener(ON_MOUSE_UP,oCbCompleted,this),o.on("click",oCbCompleted,this,!1);var a=new createjs.Container;r.addChild(a),a.x=1380,a.y=550;var n={x:0,y:0},s=s_bMobile?TEXT_INTERACTIVE_HELP_MOVE_STICK_MOBILE:TEXT_INTERACTIVE_HELP_MOVE_STICK_DESKTOP;new CTLText(a,n.x-350,n.y-100,700,200,40,"center","#fff",FONT_GAME,1.1,0,0,s,!0,!0,!0,!1);var c=this.createHand();c.x=a.x,c.y=750,r.addChild(c)},this._endMoveStickTutorial=function(){this.endTutorial(),o.removeAllEventListeners(),o.on("click",function(){})},this.removeTweens=function(){createjs.Tween.removeTweens(i)},this.toExecuteTutorial=function(e){return E[e].toExecute},this.exeTutorial=function(){return s},this.endTutorial=function(){var e=this,t=createjs.Tween.get(i);if(d.length<1)s=!1,t.to({alpha:0},500,createjs.Ease.cubicIn),t.call(function(){o.removeAllEventListeners(),i.removeChild(r),e.triggerEvent(ON_END_TUTORIAL)}),C[ON_END_TUTORIAL]=c;else{(t=createjs.Tween.get(i)).to({alpha:0},500,createjs.Ease.cubicIn),t.call(function(){var t=d.shift();if(void 0===t)return e.triggerEvent(ON_END_TUTORIAL),void(C[ON_END_TUTORIAL]=c);s=!1,r.removeAllChildren(),e.startTutorial(t)})}},this.createHand=function(){for(var e=new Array,t=0;t<HAND_ANIM_NUM_FRAMES;t++)e.push(s_oSpriteLibrary.getSprite("hand_anim_"+t));var i=s_oSpriteLibrary.getSprite("hand_anim_0"),r={images:e,frames:{width:i.width,height:i.height,regX:i.width/2,regY:i.height/2},animations:{loop:[0,19,"loop"]},framerate:30},a=new createjs.SpriteSheet(r);return createSprite(a,"loop",i.width/2,i.height/2,i.width,i.height)},this.triggerEvent=function(e){u[e]&&u[e].call(v[e],C[e])},this.addEventListener=function(e,t,i,r){u[e]=t,v[e]=i,C[e]=r},this._onPressUpButSkip=function(){o.dispatchEvent("click"),o.on("click",function(){}),d=new Array,this.endTutorial()},this.unload=function(){o.removeAllEventListeners(),t.removeChild(i)},this.refreshButtonsPos=function(){n.x=a.x=T.x-s_iOffsetX,a.y=T.y+s_iOffsetY,n.y=h.y-s_iOffsetY},this._init(e)}var INTERACTIVE_ALPHA_FADE=.01,ON_END_TUTORIAL=0,TUTORIAL_MOVE_STICK_BUTTONS=0,TUTORIAL_SHOT_DESKTOP=1,TUTORIAL_RESPOT_CUE=2,TUTORIAL_CUE_EFFECT=3,TUTORIAL_SHOT_MOBILE=4,TUTORIAL_MOVE_STICK_MOBILE=5;