function CBall(t,e,n){var i,r,s,a,o,c,l,u,h,f,_,E,g,d,A,L,C,I,b,T,O,D=t,S=e;this._init=function(t){i=!1,u=!1,_=0,r=BALL_RADIUS-.5,d=null,E=0,L=new createjs.Container,S.addChild(L);var e=s_oSpriteLibrary.getSprite("ball_shadow");if(h=createBitmap(e),h.regX=e.width/2,h.regY=e.height/2,L.addChild(h),DEBUG_SHOW_2D_SPRITE){var n={images:[s_oSpriteLibrary.getSprite("balls")],frames:{width:BALL_DIAMETER,height:BALL_DIAMETER,regX:BALL_DIAMETER/2,regY:BALL_DIAMETER/2},animations:{ball_0:0,ball_1:1,ball_2:2,ball_3:3,ball_4:4,ball_5:5,ball_6:6,ball_7:7,ball_8:8,ball_9:9,ball_10:10,ball_11:11,ball_12:12,ball_13:13,ball_14:14,ball_15:15}},f=new createjs.SpriteSheet(n);A=createSprite(f,"ball_"+D,BALL_DIAMETER/2,BALL_DIAMETER/2,BALL_DIAMETER,BALL_DIAMETER),L.addChild(A)}C=s_oScenario.create3DBall(t,BALL_3D_DIAMETER/2,new THREE.Vector3(0,0,BALL_Z_POSITION)),a=new CVector2(0,0),o=new CVector2(0,0),c=new CVector2(0,0),s=new CVector2(0,0),l=new CVector2(0,0)},this.enableEvents=function(){I=new Array,b=new Array,T=new Array,O=new Array,(f=new createjs.Shape).graphics.beginFill("#aaa").drawRect(.5*-CUE_BALL_HIT_AREA_DIMENSION,.5*-CUE_BALL_HIT_AREA_DIMENSION,CUE_BALL_HIT_AREA_DIMENSION,CUE_BALL_HIT_AREA_DIMENSION),f.alpha=.009,L.addChild(f)},this.getObject3D=function(){return C},this.render=function(t){L.x=s.getX(),L.y=s.getY()},this.setVisible=function(t){L.visible=t},this.setDragging=function(t){u=t,C.position.z=t?BALL_Z_POSITION+20:BALL_Z_POSITION},this.setMask=function(t,e){(g=new createjs.Shape).graphics.beginFill("rgba(0,0,0,0.01)").drawCircle(t,e,POOL_HOLE_RADIUS),S.addChild(g),L.mask=g},this.removeMask=function(){g&&(L.mask=null)},this.setPos=function(t,e){L.x=t,L.y=e,s.set(t,e)},this.setY=function(t){L.y=t,s.set(L.x,L.y)},this.setX=function(t){L.x=t,s.set(L.x,L.y)},this.setPrevPos=function(t){c.setV(t)},this.setPosV=function(t){s.setV(t)},this.setScale=function(t){L.scale=t},this.addPos=function(t){s.add(t)},this.addForce=function(t){a.add(t)},this.addCurForce=function(t){o.add(t)},this.setCurForce=function(t,e){o.set(t,e)},this.setCurForceV=function(t){o.setV(t)},this.setTmpForce=function(t,e){a.set(t,e)},this.normalizeCurForce=function(){o.normalize()},this.scalarProductTmpForce=function(t){a.scalarProduct(t)},this.scalarProductCurForce=function(t){o.scalarProduct(t)},this.setFlagOnTable=function(t){i=t},this.inHole=function(t){d=t},this.getHole=function(){return d},this.getTmpForce=function(){return a},this.getCurForce=function(){return o},this.getCurForceLen=function(){return o.length()},this.getCurForceLenght2=function(){return o.length2()},this.getX=function(){return s.getX()},this.getY=function(){return s.getY()},this.getPos=function(){return s},this.getPrevPos=function(){return c},this.getNumber=function(){return D},this.isBallOnTable=function(){return i},this.isDragging=function(){return u},this.getEffectForceVector=function(){return l},this.setEffectForceX=function(t){l.set(t,l.getY())},this.setEffectForceY=function(t){l.set(l.getX(),t)},this.reset3DObjectTransformation=function(){this.setOpacityMaterial3D(1),C.scale.x=C.scale.y=C.scale.z=1;var t=new THREE.Color(1,1,1);C.material.color=t},this.setOpacityMaterial3D=function(t){var e=C.material;e.transparent=!0,t>.99&&(t=1,e.transparent=!1),e.opacity=t},this.fadeAnimInHole=function(t){var e=C.material;e.transparent=!0,h.visible=!1,createjs.Tween.get(e,{override:!0}).to({opacity:0},t,createjs.Ease.sineOut);var n=C.scale;createjs.Tween.get(n).to({x:.1,y:.1,z:.1},t,createjs.Ease.sineOut).call(function(){this.setCurForce(0,0),this.setPos(POS_RAIL_EXIT.x,POS_RAIL_EXIT.y)},null,this);var i=e.color;createjs.Tween.get(i).to({r:0,g:0,b:0},.5*t,createjs.Ease.sineOut)},this.getSideEffect=function(){return E},this.setSideEffect=function(t){E=t},this.resetEdgeCollisionCount=function(){_=0},this.increaseEdgeCollisionCount=function(){_++},this.getEdgeCollisionCount=function(){return _},this._updateShadow=function(){if(h.visible){var t=new CVector2(TABLE_CENTER_COORDINATE.getX(),TABLE_CENTER_COORDINATE.getY());t.subtract(s);h.x=-.03*t.getX(),h.y=-.03*t.getY();var e=linearFunction(t.length(),770,0,0,1);h.alpha=e,t=null}},this.triggerEvent=function(t,e){I&&I[e]&&I[e].call(b[e],t,T[e])},this.addEventListener=function(t,e,n,i){I&&(I[t]=e,b[t]=n,T[t]=i,O[t]=f.on(t,this.triggerEvent,this,!1,t))},this.removeEventListener=function(t){I[t]=null,b[t]=null,T[t]=null,f.off(t,O[t]),O[t]=null},this._init(n)}